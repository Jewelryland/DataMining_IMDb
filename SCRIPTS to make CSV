1.
SELECT distinct n.gender, n.name, r.role from name n INNER JOIN cast_info c ON n.id = c.person_id INNER JOIN role_type r ON r.id = c.role_id where n.gender is not null; 

2.
SELECT distinct n.gender, n.name, r.role, t.title 
from name n INNER JOIN cast_info c ON n.id = c.person_id 
INNER JOIN role_type r ON r.id = c.role_id 
INNER JOIN title t ON t.id = c.movie_id 
where n.gender is not null limit 2000000 INTO OUTFILE '/usr/local/DbOutput/MiningTask2.csv' FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n';

3.
SELECT distinct n.gender, n.name, r.role, t.title, t.production_year, m.info 
from name n INNER JOIN cast_info c ON n.id = c.person_id 
INNER JOIN role_type r ON r.id = c.role_id 
INNER JOIN title t ON t.id = c.movie_id 
INNER JOIN movie_info m ON m.id = t.id 
where n.gender is not null and t.production_year is not null limit 2000000 
INTO OUTFILE '/usr/local/DbOutput/MiningTask3.csv' FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n';


4.
select distinct cn.country_code, ct.kind 
from company_name cn inner join mc.id 
on ct.id = mc.company_type_id
inner join company_name cn 
on cn.id = mc.company_id;

5.
select distinct cn.country_code, t.title
from company_name cn inner join movie_companies  mc
on cn.id = mc.company_id
inner join title t
on mc.movie_id = t.id;

8. 

SELECT distinct M.INFO, T.PRODUCTION_YEAR,T.SERIES_YEARS 
FROM movie_info M  INNER JOIN title T ON M.MOVIE_ID = T.ID WHERE M.INFO_TYPE_ID = 3 and t.production_year is not null and t.series_years is not null  
ORDER BY T.PRODUCTION_YEAR, T.SERIES_YEARS,M.INFO INTO OUTFILE '/usr/local/DbOutput/MiningTask8.csv' FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n';


10. 
    
SELECT distinct M.INFO,K.KIND,T.TITLE
FROM movie_info M JOIN title T JOIN kind_type K
ON M.MOVIE_ID = T.ID AND K.ID = T.KIND_ID
WHERE M.INFO_TYPE_ID = 3 AND T.KIND_ID IN (7,5,2)
ORDER BY M.INFO;

11.

SELECT distinct M.INFO, T.TITLE
FROM movie_info M JOIN title T
ON M.MOVIE_ID = T.ID
WHERE M.INFO_TYPE_ID = 107
ORDER BY M.INFO DESC;

12. 

select distinct t1.title,t2.title,m.info 
from movie_link l,title t1,title t2,movie_info m
 where link_type_id = 17 
 and t1.id = linked_movie_id 
 and t2.id = l.movie_id 
 and m.info_type_id = 3 
 and m.movie_id = t2.id 
 order by t2.title;
 
13. 
SELECT distinct M.INFO, T.TITLE
FROM movie_info M JOIN title T
ON M.MOVIE_ID = T.ID
WHERE M.INFO_TYPE_ID = 105
ORDER BY M.INFO DESC;

14. select count(movie_id) from movie_info where movie_id in (select movie_id from movie_info where info_type_id=107) and info_type_id=105;

